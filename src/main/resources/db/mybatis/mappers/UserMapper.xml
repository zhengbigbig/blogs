<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="UserMapper">
    <select id="getUserByUsernameOrEmail" parameterType="string" resultType="hello.entity.User">
        select * from user
        where username = #{username} or email = #{username}
    </select>

    <insert id="insertUser" parameterType="Map">
        insert into user (username, encrypted_password, email, created_at, updated_at)
        values (#{username},#{password},#{email},current_timestamp ,current_timestamp);
    </insert>

    <update id="updateUser" parameterType="hello.entity.User">
        update user
        <set>
            <if test="username != null">`username` = #{username}, </if>
            <if test="encryptedPassword != null">`encrypted_password` = #{encryptedPassword}, </if>
            <if test="avatar != null">`avatar` = #{avatar}, </if>
            <if test="email != null">`email` = #{email}, </if>
            <if test="sex != null">`sex` = #{sex}, </if>
            <if test="summary != null">`summary` = #{summary}, </if>
            <if test="profession != null">`profession` = #{profession}</if>
            <if test="address != null">`address` = #{address}</if>
            <if test="technologyStack != null">`technology_stack` = #{technologyStack}</if>
            <if test="updatedAt != null">`updated_at` = #{updatedAt}</if>
        </set>
        where id = #{id}
    </update>
</mapper>